# control-money\n\nAplicación web para gestionar finanzas personales: ingresos, gastos, categorías, recibos y visualizaciones.\n\n## Stack\n\n- React + Vite + TypeScript\n- Supabase (Auth, Postgres, Storage)\n- TailwindCSS (tema emerald + slate)\n- React Query\n- Recharts (gráficos, pendiente)\n- Sonner (notificaciones)\n- Radix UI primitives\n\n## Scripts\n\n```bash\npnpm install\npnpm dev\npnpm build\npnpm preview\npnpm lint\npnpm lint:fix\npnpm typecheck\n```\n\n## Variables de entorno\n\nCrear `.env.local`:\n\n````\nVITE_SUPABASE_URL=\nVITE_SUPABASE_ANON_KEY=\n````\n\n## Tablas mínimas\n\n```sql\ncreate table public.profiles (\n  id uuid primary key references auth.users(id) on delete cascade,\n  full_name text,\n  avatar_url text,\n  created_at timestamptz default now()\n);\n\ncreate table public.categories (\n  id uuid primary key default gen_random_uuid(),\n  user_id uuid references auth.users(id) on delete cascade,\n  name text not null,\n  type text not null check (type in ('income','expense')),\n  icon text,\n  created_at timestamptz default now()\n);\n\ncreate table public.transactions (\n  id uuid primary key default gen_random_uuid(),\n  user_id uuid not null references auth.users(id) on delete cascade,\n  category_id uuid references public.categories(id) on delete set null,\n  type text not null check (type in ('income','expense')),\n  amount numeric not null,\n  currency text not null default 'CLP',\n  description text,\n  tx_date date not null,\n  receipt_url text,\n  created_at timestamptz default now(),\n  updated_at timestamptz default now()\n);\n\ncreate index on public.transactions (user_id, tx_date desc);\n```\n\n## Trigger creación de perfil\n\n```sql\ncreate or replace function public.handle_new_user()\nreturns trigger as $$\nbegin\n  insert into public.profiles (id, full_name, avatar_url)\n  values (new.id, new.raw_user_meta_data->>'full_name', null);\n  return new;\nend;\n$$ language plpgsql security definer;\n\ndrop trigger if exists on_auth_user_created on auth.users;\ncreate trigger on_auth_user_created\nafter insert on auth.users\nfor each row execute function public.handle_new_user();\n```\n\n## Bucket de recibos\n\nCrear bucket `receipts` (privado recomendado). Para mostrar archivos: generar signed URLs.\n\n## Próximos pasos\n\n- Formulario CRUD transacciones (react-hook-form + zod)\n- Mutations + invalidación (create/update/delete)\n- Subida de recibos (PDF / imagen)\n- Gráficos dashboard\n- Tests (Vitest + Testing Library)\n- Tipos generados de Supabase:\n  `supabase gen types typescript --project-id <id> --schema public > src/types/supabase.ts`\n\n## Licencia\n\nMIT\n